ƒанна€ программа удал€ет сама себ€ и, в случае обнаружени€ отладчика, запрещает работу с клавиатурой.

—тоит отметить, что последовательность команд
mov ax,1201h
mob bl,32h
int 10h
не приводит к зависанию отладчика ни в программной оболочке Windows XP, ни в DOS-BOX.

ѕоследовательность команд 
mov al,0adh
out 64h,al
запрещает работу с клавиатурой в программной оболочке Windows XP, но не запрещает в DOS-BOX.