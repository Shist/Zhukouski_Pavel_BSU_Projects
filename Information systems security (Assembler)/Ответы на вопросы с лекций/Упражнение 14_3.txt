Вопрос №3: «Почему и зачем в регистр СХ помешается значение, равное 27h, а область памяти DTA описана как 43 байта?»
Ответ:
Структура DTA имеет общий размер 43 байта. 27h (16-я система счисления) = 39 (10-я с.с.). То есть выделяем достаточно памяти под все поля, а 4 дополнительных байта нужны для размера файла.
Рассмотрим структуру DTA побайтово:
1) 1 байт на ASCII-буквы привода и сетевой диск
2) 11 байт на маску поиска
3) 1 байт на атрибуты поиска
4) 2 байта на порядковый номер файла в директории
5) 2 байта на номер кластера начала внешней директории
6) 4 байта зарезервировано
7) 1 байт на атрибут найденного файла
8) 2 байта на время создания файла (в формате DOS)
9) 2 байта на дату создания файла (в формате DOS)
10) 4 байта на размер файла (об этом позже)
11) 13 байт на ASCIIZ-имя найденного файла с расширением
Если посчитать общую сумму байт во всей структуре DTA, то получится следующее:
1 + 11 + 1 + 2 + 2 + 4 + 1 + 2 + 2 + 4 + 13 = 43 байта.
Если перевести число 27h из шестнадцатеричной системы счисления в десятеричную, то получится 39. Если мы поместим число 39 в регистр CX, то мы обеспечим DTA достаточным количеством памяти (размер файла, который весит 43 — 39 = 4 байта, мы не учитываем).
 
--
Жуковский Павел, 4 курс, 12 группа